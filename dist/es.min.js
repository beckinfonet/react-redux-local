import{Component}from"react";import{func,objectOf,arrayOf,object}from"prop-types";import{createStore,applyMiddleware,bindActionCreators}from"redux";import createSagaMiddleware from"redux-saga";import{composeWithDevTools}from"redux-devtools-extension";class LocalReducer extends Component{constructor(e){super(e);const{reducer:t,saga:s,middleware:o,actions:r,devToolsOptions:i}=e;this.sagaMiddleware=s&&createSagaMiddleware();const a=[...o];this.sagaMiddleware&&a.push(this.sagaMiddleware);const d=applyMiddleware(...a),c=composeWithDevTools(i);this.state=t(void 0,{}),this.store=createStore(t,i?c(d):d),this.store.subscribe(()=>this.setState(this.store.getState())),this.dispatch=this.dispatch.bind(this),this.boundActions=bindActionCreators(r,this.dispatch)}componentWillMount(){const{saga:e}=this.props;e&&(this.saga=this.sagaMiddleware.run(e))}componentWillUnMount(){const{saga:e}=this.props;e&&this.saga.cancel()}dispatch(e={}){this.store.dispatch(e)}render(){return this.props.render(this.state,this.boundActions,this.dispatch)}}LocalReducer.propTypes={reducer:func.isRequired,actions:objectOf(func.isRequired).isRequired,saga:func,middleware:arrayOf(func.isRequired),render:func.isRequired,devToolsOptions:object},LocalReducer.defaultProps={middleware:[]};export default LocalReducer;
